<SelectableLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (0, 0, 0, 1)
        Rectangle:
            size: self.size
            pos: self.pos

    active: True
    BoxLayout:
        padding: 5
        Label:
            id: one
            halign: 'left'
            text: root.value
        CheckBox:
            active: root.active
            size_hint_x: 0.06
            id: two
            on_active: app.alarm_active(root.index, self.active)
        ButtonImage:
            size_hint_x: 0.05
            source: 'img/edit.png'
            on_press: app.alarm_edit(root.index,root.more)

<RVSAlarmScreen>
    on_touch_down:
        app.reset_blank()
    rv: rv
    RecycleView:
        id: rv
        viewclass: 'SelectableLabel'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            multiselect: False
            touch_multiselect: True
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        ButtonImage:
            size: 50,50
            size_hint: None, None
            source: 'img/add_2.png'
            on_press: app.add_alarm()
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        ButtonImage:
            size: 50,50
            size_hint: None, None
            source: 'img/home.png'
            on_press: app.show_clock()


<AlarmScreen>:
    on_touch_down:
        app.reset_blank()
    FloatLayout:
        size: self.size
        canvas:
            Color:
                rgba: .5, .3, .55, .5
            Rectangle:
                size: self.size
                pos: self.pos
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: 0.1
                Label:
                    text: root.AlarmText+' '+ str(root.index)
                    font_size: self.height * 0.7

        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.2
            pos: (0,root.height-self.height*1.5)
            BoxLayout:
                canvas:
                    Color:
                        rgba: .5, .3, .55, .5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                size_hint_y: .2
                Label:
                    text: 'Type'
                    font_size: self.height * 0.7
                    text_size: self.size
                ToggleButton:
                    id: daily
                    text: 'daily'
                    size_hint_x:0.25
                    font_size: self.height * 0.7
                    on_touch_down:
                        root.AlarmType = 'daily'
                        self.state= 'normal'
                        print(root.AlarmType)
                    group: 'type'
                ToggleButton:
                    id: single
                    text: 'single'
                    size_hint_x:0.25
                    font_size: self.height * 0.7
                    on_touch_down:
                        root.AlarmType = 'single'
                        self.state= 'normal'
                        print(root.AlarmType)
                    group: 'type'
            BoxLayout:
                size_hint_y: .2
                Label:
                    text: 'Time'
                    font_size: self.height * 0.7
                    text_size: self.size
                Spinner:
                    size_hint_x: .18
                    font_size: self.height * 0.7
                    values: ['{:02d}'.format(x) for x in range(24)]
                    text: root.Hour
                    id: 'hour'
                    on_text:
                        root.Hour = self.text
                Label:
                    size_hint_x: .1
                    text: ':'
                Spinner:
                    size_hint_x: .18
                    font_size: self.height * 0.7
                    values: ['{:02d}'.format(x) for x in range(0,60,5)]
                    text: root.Minute
                    id: 'minute'
                    on_text:
                        root.Minute=self.text

        BoxLayout:
            size_hint_y:0.1
            pos: (0,240) if root.AlarmType=='daily' else (-root.width,240)
            orientation: 'horizontal'
            ToggleButton:
                text: 'mon'
                state: 'down' if root.Days[0] else 'normal'
                on_state:
                    root.Days[0]= False if self.state=='normal' else True
            ToggleButton:
                text: 'tue'
                state: 'down' if root.Days[1] else 'normal'
                on_state:
                    root.Days[1]= False if self.state=='normal' else True
            ToggleButton:
                text: 'wed'
                state: 'down' if root.Days[2] else 'normal'
                on_state:
                    root.Days[2]= False if self.state=='normal' else True
            ToggleButton:
                text: 'thu'
                state: 'down' if root.Days[3] else 'normal'
                on_state:
                    root.Days[3]= False if self.state=='normal' else True
            ToggleButton:
                text: 'fri'
                state: 'down' if root.Days[4] else 'normal'
                on_state:
                    root.Days[4]= False if self.state=='normal' else True
            ToggleButton:
                text: 'sat'
                state: 'down' if root.Days[5] else 'normal'
                on_state:
                    root.Days[5]= False if self.state=='normal' else True
            ToggleButton:
                text: 'sun'
                state: 'down' if root.Days[6] else 'normal'
                on_state:
                    root.Days[6]= False if self.state=='normal' else True

        BoxLayout:
            #pos: (0,root.height-100)
            size_hint_y:  0.1
            pos: (0,240) if root.AlarmType=='single' else (-root.width,240)
            Label:
                text: 'Date'
                font_size: self.height * 0.7
                text_size: self.size
            Spinner:
                size_hint_x: .18
                font_size: self.height * 0.7
                values: ['{:02d}'.format(x) for x in range(1,31)]
                text: self.values[0]
                id: 'day'
            Label:
                size_hint_x: .1
                text: '.'
            Spinner:
                size_hint_x: .18
                font_size: self.height * 0.7
                values: ['{:02d}'.format(x) for x in range(1,12)]
                text: self.values[0]
                id: 'month'
        BoxLayout:
            size_hint_y: 0.1
            pos: (0,140)
            Label:
                text: 'Media'
                font_size: self.height * 0.7
                text_size: self.size
            Label:
                text: root.media
            Button:
                text: '...'
                size_hint_x: 0.1
                on_press:
                    app.choose_alarm_media(root.index)
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'bottom'
            size_hint_y: 0.1
            BoxLayout:
                orientation: 'horizontal'
                canvas:
                    Color:
                        rgba: .5, .3, .55, .5
                    Rectangle:
                        size: self.size
                        pos: self.pos
                Button:
                    text: 'OK'
                    on_press:
                        app.set_alarm(root.index)
                Button:
                    text: 'cancel'
                    on_press:
                        app.cancel()

